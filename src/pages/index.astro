---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

// è·å–æ ‡ç­¾æ•°æ®
const posts = await getCollection('posts');
const tagCounts = posts.reduce((acc, post) => {
  post.data.tags.forEach(tag => {
    acc[tag] = (acc[tag] || 0) + 1;
  });
  return acc;
}, {} as Record<string, number>);

const topTags = Object.entries(tagCounts)
  .sort((a, b) => b[1] - a[1])
  .slice(0, 8); // åªæ˜¾ç¤ºå‰8ä¸ª
---

<BaseLayout>
  <div style="min-height: calc(100vh - 200px); display: flex; flex-direction: column; justify-content: center; padding: 2rem 0;">
    <div>
      <h1 style="font-size: clamp(2.5rem, 6vw, 4rem); font-weight: 800; line-height: 1.1; margin-bottom: 1.5rem;">
        ä½ å¥½ï¼Œæˆ‘æ˜¯<br>
        <span style="color: var(--accent);">Kraken</span>
      </h1>
      
      <p style="font-size: 1.125rem; color: #666; max-width: 520px; line-height: 1.6; margin-bottom: 0.25rem;">
        è¿™é‡Œè®°å½•æˆ‘çš„æŠ€æœ¯æ¢ç´¢ã€ç”Ÿæ´»ç¬é—´å’Œå¥‡æ€å¦™æƒ³ã€‚
      </p>
      <p style="font-size: 1.125rem; color: #666; max-width: 520px; line-height: 1.6;">
        æ­£åœ¨å­¦ä¹ ã€åˆ›é€ å’Œåˆ†äº«çš„è·¯ä¸Šã€‚
      </p>
    </div>

    <div style="margin-top: 4rem; display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 1.5rem;">
      <a href="/posts" class="card">
        <div class="card-icon">ğŸ“</div>
        <h3 class="card-title">æ–‡ç« </h3>
        <p class="card-desc">æŠ€æœ¯æ€è€ƒä¸å­¦ä¹ ç¬”è®°</p>
      </a>

      <a href="/projects" class="card">
        <div class="card-icon">ğŸ’»</div>
        <h3 class="card-title">é¡¹ç›®</h3>
        <p class="card-desc">GitHub å¼€æºä½œå“å±•ç¤º</p>
      </a>

      <a href="/life" class="card">
        <div class="card-icon">ğŸ“·</div>
        <h3 class="card-title">ç”Ÿæ´»</h3>
        <p class="card-desc">ç…§ç‰‡ã€è§†é¢‘ä¸æ—¥å¸¸è®°å½•</p>
      </a>
    </div>

    <!-- æ·»åŠ æ ‡ç­¾äº‘ -->
    {topTags.length > 0 && (
      <div style="margin-top: 3rem;">
        <h3 style="font-size: 1rem; color: #666; margin-bottom: 1rem; text-transform: uppercase; letter-spacing: 0.05em;">çƒ­é—¨æ ‡ç­¾</h3>
        <div style="display: flex; flex-wrap: wrap; gap: 0.75rem;">
          {topTags.map(([tag, count]) => (
            <a href={`/tags/${tag}`} class="tag">
              {tag} <span style="color: #666; margin-left: 0.25rem;">{count}</span>
            </a>
          ))}
          <a href="/tags" style="color: var(--accent); font-size: 0.875rem; display: flex; align-items: center;">æŸ¥çœ‹å…¨éƒ¨ â†’</a>
        </div>
      </div>
    )}
  </div>
</BaseLayout>

<style>
  .card {
    padding: 2rem;
    background: var(--secondary);
    border: 1px solid var(--border);
    border-radius: 12px;
    text-decoration: none;
    color: inherit;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .card:hover {
    transform: translateY(-8px);
    border-color: var(--accent);
    box-shadow: 0 20px 40px rgba(255, 107, 53, 0.15);
  }
  
  .card-icon {
    font-size: 2rem;
    margin-bottom: 1rem;
  }
  
  .card-title {
    color: var(--accent);
    margin-bottom: 0.5rem;
    font-size: 1.25rem;
    font-weight: 600;
  }
  
  .card-desc {
    color: #666;
    font-size: 0.95rem;
    line-height: 1.6;
  }

  .tag {
    padding: 0.375rem 0.875rem;
    background: var(--secondary);
    border: 1px solid var(--border);
    border-radius: 9999px;
    text-decoration: none;
    color: var(--text);
    font-size: 0.875rem;
    transition: all 0.2s;
  }
  
  .tag:hover {
    border-color: var(--accent);
    color: var(--accent);
  }
</style>